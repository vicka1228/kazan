# Kazan

A website that would help people find their favorite artists’ concerts. The website can keep track of your top artists and depending on which concert you want to go to, it would analyze the previous prices for the artist and the venue and try to give a predicted price. We came up with this idea because as study away students we noticed that many of us wanted to take the opportunity to see popular and personally favorite artists on stage, but it is limiting to do so with our budgets and this applies to most university students. Hence Kazan would help people by finding the lowest prices, recommending concerts you might not have heard about (but still from the artists you like), and giving a predictor of whether you should wait to buy the ticket or not!

## Data Collection and Backend:

We use the Spotify API to get the top artists of a user and the popularity rating and other information about an artist, and the Ticketmaster API to find a list of events, venues, and prices for the particular artist. We also find the population for the cities through the opendatasoft API. We have made a sqlite 3 database with the columns we deemed fitting for the training of our ML model. From our backend, many of our functionalities could have been achieved by searching through this database (as a CSV) but that would not be the most updated information, and also might not have each and every artist the user could search for. Hence, we try to make direct API calls from the backend. The dataset should ideally be updated regularly so that our ML model getes more and more data to train on. Currently it has 1500+ data points taken from the top artists of Spotify, not from any particular user.

Our backend is hosted through Flask. We converted our python functions to Flask APIs and made routes for each of them. These functions are for the purposes of getting the top artists of a user, getting a concert list of these top artists, getting a concert list of a particular artist, getting concert information of a particular concert, and the links to images of the concerts and artists. These are all made through the ticketmaster and Spotify APIs so that the information is the most updated. We also have a search function which we only apply on our existing database as doing it through the ticketmaster API would limit it to only one field (i.e. only search by artist or concert or venue etc.) Through this current system you can search through anything. We plan to update the database once every week and clean it by throwing out the irrelevant data. It’s not the most efficient or accurate system but it’s what makes the most sense for the seach feature right now. 

## Machine Learning:

The machine learning part of the code is used to predict the minimum price of a concert ticket using a Random Forest algorithm with bagging. The code starts off by creating a OneHotEncoder object to encode categorical data. This is then used in the get_data() function to select features from the dataset and encode the categorical data. The split() function is used to split the dataframe into train and test sets. The train_model() function uses the BaggingRegressor to create a model with the most optimal number of estimators. This is then used to train the model. Lastly, the predict() function is used to predict the prices of the tickets using the previously created model. The most optimal number of parameters is 100 for us. As shown during the presentation, 100 parameters performed similarly to 500, however, 100 is faster and more than enough for us.  The mean_average_error() function is then used to evaluate the accuracy of the model using MAE(mean average error).

 The random forest with bagging is applicable for predicting concert ticket prices because it is a powerful machine learning algorithm that can be used to accurately predict prices from a variety of parameters. The bagging technique is also useful because it reduces overfitting and increases the accuracy of the predictions. The random forest is also capable of handling a variety of data types, such as categorical and numerical data, which can be useful for predicting ticket prices. Additionally, the random forest is relatively quick to train, which can be important when predicting prices as they can change quickly.

In the beginning, we used pandas.get_dummies() to one hot encode the categorical data. However, later we ran into the problem of encoding unforeseen data. The new concert information couldn’t be encoded the same way the train data was encoded, hence predicting was not possible. That’s why we switched to the OneHotEncoder, which has the advantage over panda.get_dummies() in that it can handle unknown categories in the data, as well as categorical data with a large number of categories. It also has the ability to transform data with high cardinality (i.e. many categories) more efficiently. The OneHotEncoder also has the ability to map numerical values to categories, which can be useful when trying to predict the prices of tickets.

## Frontend and User Interactivity:

As soon as you open our application, you will be asked to sign in through Spotify. When you click on the button it redirects you to the Spotify login. Once you login to your account you are able to view our home page, where it shows you your top 10 artists from Spotify and any concerts they have listed currently. You can click on an artist to get a concert list by artist, or click on a concert card to get more information about the concert. When you click on a concert to get information about it, you will see the current minimum price of the concert and what our predicted minimum is, and it will recommend whether you should buy it or not based on that. There is also a search feature if you want to look at some concerts apart from the ones in your top 10 on Spotify. Currently our search is limited to the concerts in our dataset so that the feature gets more flexibility in terms of whether you are searching for concerts or artists or venues. We can certainly work on making the search real-time too in the future.

The front-end was implemented through React.js as that fit the kind of user experience and design we wanted to have. It makes calls to our Flask backend through axios and uses typical React components for things such as Concert Cards and Artist Cards which are repeated. We tried to give it a simple and sleek design which embodies the Spotify colours.

## Limitations and Extensions:

The Spotify auth token not getting authenticated is limiting all the functionality of our app currently. While you are redirected to login, after that almost everything requires knowing the details of the specific user’s account but that token is not getting saved. Hence to view the app you would have to view the hard-coded version (please contact us for this).
We were not able to find a public source for past data on concert prices. The Wayback machine shows us past concert lists but doesn’t allow us to click on a particular event to view the concert, doing that is impossible without knowing the event ID for each concert of the past.
We think the concept of our app could definitely be extended to things such as Broadway shows, sports events, movie tickets, and basically anything which requires a ticket. There are also other utilities we can add and polish, such as having partnerships with specific platforms to make the ticketing process easier.
